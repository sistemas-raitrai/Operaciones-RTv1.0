<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0" />
  <title>En vivo | Dónde están los grupos</title>

  <link rel="stylesheet" href="estilos.css" />
  <link rel="icon" type="image/png" href="Logo Raitrai.png" />

  <style>
    :root{
      --bg:#0b1020;          /* fondo general */
      --card:#111a36;        /* tarjeta */
      --ink:#e8eefc;         /* texto principal */
      --muted:#9fb0d1;       /* texto secundario */
      --line:#2a3a67;        /* bordes */
      --accent:#6ea8ff;      /* acento (ahora) */
      --ok:#1db954;          /* verde sutil */
      --fade:.35s;

      /* >>> ancho mínimo de columna (DOBLE respecto a 280px) */
      --col-min: 350px;
    }
    *{ box-sizing:border-box; }
    body.envivo{ background:var(--bg); color:var(--ink); font-family:system-ui,-apple-system,"Segoe UI",Roboto,Arial,sans-serif; }

    /* Header (ocultable) */
    .envivo header.hideable-ui{
      display:flex; align-items:center; gap:.75rem;
      padding:.6rem 1rem; border-bottom:1px solid rgba(255,255,255,.08);
      position:sticky; top:0; backdrop-filter:saturate(1.2) blur(6px); background:rgba(11,16,32,.7);
      z-index:10;
    }
    .envivo header img{ height:34px; width:auto; }
    .envivo header h1{ font-size:1.1rem; margin:0; font-weight:700; }
    .envivo .toolbar{ margin-left:auto; display:flex; align-items:center; gap:.5rem; flex-wrap:wrap; }
    .envivo .toolbar label{ font-size:.8rem; color:var(--muted); }
    .envivo .toolbar select,.envivo .toolbar input,.envivo .toolbar button{
      background:var(--card); color:var(--ink); border:1px solid var(--line);
      padding:.45rem .6rem; border-radius:.6rem; font-size:.9rem;
    }
    .envivo .toolbar input[type="range"]{ width:120px; }
    .envivo .toolbar button{ cursor:pointer; }
    .envivo .toolbar .multi{ min-width:260px; max-width:380px; height:8.5rem; }

    .envivo .content{ padding:1rem; display:grid; gap:1rem; }
    .envivo .pill{ font-size:.75rem; color:var(--muted); padding:.15rem .5rem; border:1px solid var(--line); border-radius:999px; }

    /* Bloques por destino */
    .envivo .destino-bloque{
      border:1px solid var(--line); border-radius:14px;
      background:linear-gradient(180deg,rgba(255,255,255,.03),rgba(255,255,255,.015));
      opacity:1; transition:opacity var(--fade) ease;
    }
    .envivo .destino-bloque.fade-out{ opacity:.02; }
    .envivo .destino-bloque.is-hidden{ display:none; }
    .envivo .destino-hd{ padding:.85rem 1rem; border-bottom:1px solid var(--line); display:flex; align-items:center; gap:.6rem; }
    .envivo .destino-hd h2{ margin:0; font-size:1rem; font-weight:700; letter-spacing:.2px; }

    /* >>> grilla de tarjetas (usa col-min y fuerza la regla) */
    .envivo .grupo-grid{
      display:grid;
      grid-template-columns:repeat(auto-fill, minmax(var(--col-min), 1fr)) !important;
      gap:1rem; padding:1rem;
    }

    /* Tarjeta */
    .envivo .group-card{
      background:var(--card); border:1px solid var(--line); border-radius:16px; padding:1rem;
      display:grid; gap:.65rem; box-shadow:0 6px 18px rgba(0,0,0,.18);
    }
    .envivo .group-card h3{ margin:0; font-size:1rem; line-height:1.15; font-weight:800; letter-spacing:.3px; text-transform:uppercase; }
    .envivo .sub{ font-size:.82rem; color:var(--muted); line-height:1.25; }

    /* Triptych (Antes/Ahora/Después) */
    .envivo .stage{ display:grid; gap:.35rem; }
    .envivo .stage-hd{ font-size:.78rem; color:var(--muted); }
    .envivo .stage-box{
      border:1px dashed var(--line); border-radius:12px; padding:.6rem .7rem; min-height:54px;
      display:grid; align-content:center; justify-items:center; text-align:center; background:rgba(255,255,255,.03);
    }
    .envivo .stage-box .title{ font-weight:800; font-size:.95rem; letter-spacing:.2px; text-transform:uppercase; }
    .envivo .stage-box .time{ font-size:.78rem; color:var(--muted); margin-top:.15rem; }
    .envivo .stage-now{ border-style:solid; border-color:rgba(110,168,255,.5);
      background:linear-gradient(180deg, rgba(110,168,255,.18), rgba(44,111,255,.15));
      box-shadow:0 0 0 3px rgba(44,111,255,.08) inset, 0 8px 28px rgba(44,111,255,.15);
    }
    .envivo .stage-now .title{ color:#f5f9ff; font-size:1.05rem; }
    .envivo .stage-now .time{ color:#d8e7ff; }

    /* Día completo */
    .envivo .day-list{ display:grid; gap:.5rem; }
    .envivo .act-item{
      border:1px dashed var(--line); border-radius:10px; padding:.5rem .7rem;
      display:flex; justify-content:space-between; gap:.8rem; align-items:baseline;
      background:rgba(255,255,255,.03);
    }
    .envivo .act-item .name{ font-weight:800; text-transform:uppercase; font-size:.95rem; }
    .envivo .act-item .time{ font-size:.8rem; color:var(--muted); white-space:nowrap; }
    .envivo .act-item.is-now{ border-color:rgba(110,168,255,.6);
      background:linear-gradient(180deg, rgba(110,168,255,.18), rgba(44,111,255,.15));
    }
    .envivo .act-item.is-past{ opacity:.6; }

    /* Modo monitor: oculta header + HUD */
    body.envivo.monitor .hideable-ui{ display:none !important; }
    .envivo .hud{
      position:fixed; right:12px; bottom:10px; background:rgba(0,0,0,.45);
      border:1px solid var(--line); border-radius:999px; padding:.25rem .6rem;
      font-size:.78rem; color:var(--muted); z-index:9999; cursor:pointer;
    }
    body.envivo:not(.monitor) .hud{ display:none; }

    @media print{
      .envivo .hideable-ui{ display:none !important; }
      body.envivo{ background:#fff; color:#000; }
      .envivo .group-card,.envivo .destino-bloque{ background:#fff; border:1px solid #ccc; box-shadow:none; }
    }
  </style>
</head>

<body class="envivo">

  <!-- Header -->
  <header class="hideable-ui">
    <img src="Logo Raitrai.png" alt="Rai Trai" />
    <h1>¿Dónde están los grupos?</h1>

    <div class="toolbar">
      <label>Destino</label>
      <select id="filtroDestino">
        <option value="__ALL__">Todos</option>
      </select>

      <label>Simular</label>
      <input id="simNow" type="datetime-local" />

      <label>Modo</label>
      <select id="autoMode">
        <option value="__OFF__">Apagado</option>
        <option value="CAROUSEL">Carrusel destinos</option>
        <option value="SCROLL">Scroll suave</option>
      </select>

      <label>Velocidad</label>
      <input id="autoSpeed" type="range" min="1" max="10" value="5" />
      <span class="pill" id="speedLabel">x5</span>

      <label>Vista</label>
      <select id="viewMode">
        <option value="TRIPTYCH">Antes / Ahora / Después</option>
        <option value="FULL_DAY">Itinerario del día</option>
      </select>

      <label>Ocultar actividades</label>
      <select id="actFilter" class="multi" multiple></select>
      <button id="btnClearActs" title="Limpiar selección">Limpiar filtros</button>
      <span class="pill" id="hiddenCount">0 ocultas</span>

      <button id="btnNowReal" title="Usar ahora real">En Vivo</button>
      <button id="btnRefrescar" title="Refrescar ahora">Actualizar</button>
      <button id="btnToggleUI" title="Ocultar/Mostrar panel (M)">Ocultar panel</button>
      <span class="pill" id="lastRefresh">—</span>
    </div>
  </header>

  <main class="content" id="contenedor"></main>

  <!-- HUD clickeable -->
  <div id="hud" class="hud" title="Click para mostrar/ocultar panel · [M] UI · [F] Pantalla completa"></div>

  <script type="module" src="./envivo.js"></script>
</body>
</html>
