<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0" />
  <title>Turnos de Comida Bariloche | RT v1.0</title>
  <link rel="stylesheet" href="estilos.css" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/choices.js/public/assets/styles/choices.min.css" />
  <link rel="icon" type="image/png" href="Logo Raitrai.png" />

  <!-- Estilos m칤nimos espec칤ficos de este m칩dulo (puedes moverlos a estilos.css) -->
  <style>
    .turnos-header {
      display:flex;
      flex-wrap:wrap;
      gap:1rem;
      align-items:flex-end;
      margin-bottom:1rem;
      border-bottom:1px solid #e5e7eb;
      padding-bottom:.75rem;
    }
    .turnos-header h2 {
      margin:0;
      font-size:1.2rem;
      text-transform:uppercase;
      letter-spacing:.08em;
    }
    .turnos-header .subtitle {
      font-size:.9rem;
      color:#6b7280;
      margin-top:.15rem;
    }
    .turnos-header .field-group {
      display:flex;
      flex-wrap:wrap;
      gap:.75rem;
      margin-left:auto;
    }
    .turnos-header .field {
      display:flex;
      flex-direction:column;
      gap:.15rem;
      font-size:.8rem;
    }
    .turnos-header .field label {
      font-weight:600;
      text-transform:uppercase;
      letter-spacing:.06em;
      color:#6b7280;
      font-size:.7rem;
    }
    .turnos-header .field input {
      padding:.3rem .5rem;
      border-radius:999px;
      border:1px solid #d1d5db;
      font-size:.85rem;
    }

    .btn-small {
      padding:.35rem .7rem;
      border-radius:999px;
      border:1px solid #111827;
      background:#111827;
      color:#fff;
      font-size:.75rem;
      text-transform:uppercase;
      letter-spacing:.08em;
      cursor:pointer;
      white-space:nowrap;
    }
    .btn-small.secondary {
      background:#e5e7eb;
      color:#111827;
      border-color:#d1d5db;
    }
    .btn-small + .btn-small { margin-left:.25rem; }

    .panel-box {
      background:#fff;
      border-radius:10px;
      border:1px solid #e5e7eb;
      padding:.75rem .9rem;
      box-shadow:0 1px 2px rgba(0,0,0,.04);
    }
    .panel-box h3 {
      margin:0 0 .35rem;
      font-size:.9rem;
      text-transform:uppercase;
      letter-spacing:.08em;
      color:#4b5563;
    }
    .panel-box .panel-sub {
      font-size:.75rem;
      color:#9ca3af;
      margin-bottom:.5rem;
    }

    .badge-chip {
      display:inline-flex;
      align-items:center;
      gap:.25rem;
      border-radius:999px;
      border:1px solid #e5e7eb;
      padding:.15rem .55rem;
      font-size:.75rem;
      background:#f9fafb;
      color:#4b5563;
    }

    /* Tabla de grupos */
    #tablaGrupos {
      width:100%;
      border-collapse:collapse;
      font-size:.8rem;
    }
    #tablaGrupos th,
    #tablaGrupos td {
      padding:.35rem .4rem;
      border-bottom:1px solid #e5e7eb;
      text-align:left;
    }
    #tablaGrupos th {
      font-size:.7rem;
      text-transform:uppercase;
      letter-spacing:.08em;
      color:#6b7280;
      background:#f9fafb;
      position:sticky;
      top:0;
      z-index:1;
    }
    #tablaGrupos tbody tr:nth-child(even){
      background:#f9fafb;
    }
    #tablaGrupos tbody tr:hover{
      background:#eef2ff;
    }
    .coord-tag{
      display:inline-flex;
      align-items:center;
      gap:.25rem;
      font-size:.75rem;
      padding:.1rem .4rem;
      border-radius:999px;
      background:#eff6ff;
      color:#1d4ed8;
    }
    .coord-dot{
      width:6px;height:6px;border-radius:999px;
      background:#1d4ed8;
    }
    .select-turno {
      width:100%;
      padding:.18rem .35rem;
      border-radius:999px;
      border:1px solid #d1d5db;
      font-size:.75rem;
      background:#fff;
    }

    /* Panel derecho: tarjetas de turnos */
    .turnos-grid {
      display:grid;
      grid-template-columns:1fr;
      gap:.5rem;
    }
    .turno-card {
      border-radius:10px;
      border:1px solid #e5e7eb;
      padding:.55rem .6rem;
      background:#f9fafb;
    }
    .turno-header {
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:.5rem;
      font-size:.75rem;
      text-transform:uppercase;
      letter-spacing:.08em;
      margin-bottom:.35rem;
    }
    .turno-pill {
      display:inline-flex;
      align-items:center;
      gap:.35rem;
      border-radius:999px;
      border:1px solid #e5e7eb;
      padding:.2rem .5rem;
      font-size:.7rem;
      background:#fff;
    }
    .turno-badge {
      font-weight:600;
    }
    .turno-status-ok    { color:#15803d; }
    .turno-status-warn  { color:#a16207; }
    .turno-status-danger{ color:#b91c1c; }

    .turno-list {
      list-style:none;
      padding:0;
      margin:0;
      max-height:120px;
      overflow:auto;
      font-size:.78rem;
    }
    .turno-list li {
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:.5rem;
      padding:.2rem 0;
      border-bottom:1px dashed #e5e7eb;
    }
    .turno-list li span:first-child{
      flex:1;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }
    .turno-list li span:last-child{
      white-space:nowrap;
      color:#6b7280;
    }

    /* WhatsApp text area */
    .whats-box textarea {
      width:100%;
      min-height:110px;
      resize:vertical;
      border-radius:8px;
      border:1px solid #d1d5db;
      font-size:.8rem;
      padding:.4rem .45rem;
      font-family:ui-monospace,Menlo,Monaco,"SF Mono",monospace;
      background:#f9fafb;
    }
    .whats-box .help {
      font-size:.75rem;
      color:#6b7280;
      margin-top:.25rem;
    }

    @media (max-width: 900px){
      .turnos-header {
        flex-direction:column;
      }
      .turnos-header .field-group {
        margin-left:0;
      }
    }
  </style>
</head>
<body class="itinerario-page"><!-- puedes usar otra clase si tienes una para m칩dulos nuevos -->

  <div id="encabezado"></div>

  <main class="main">
    <!-- ENCABEZADO DEL M칍DULO -->
    <section class="turnos-header">
      <div>
        <h2>Turnos de Comida 췅 Bariloche</h2>
        <div class="subtitle">
          Asignaci칩n de almuerzos y cenas por grupo / coordinador con capacidad m치xima por turno.
        </div>
      </div>

      <div class="field-group">
        <div class="field">
          <label for="fechaTurno">Fecha</label>
          <input type="date" id="fechaTurno" />
        </div>
        <div class="field">
          <label for="maxPaxTurno">M치x. pax turno</label>
          <input type="number" id="maxPaxTurno" min="1" value="96" />
        </div>
        <div class="field">
          <label>Horarios Almuerzo</label>
          <div style="display:flex;gap:.25rem;">
            <input type="time" id="horaAlm1" value="12:00" />
            <input type="time" id="horaAlm2" value="13:00" />
            <input type="time" id="horaAlm3" value="14:00" />
          </div>
        </div>
        <div class="field">
          <label>Horarios Cena</label>
          <div style="display:flex;gap:.25rem;">
            <input type="time" id="horaCen1" value="20:00" />
            <input type="time" id="horaCen2" value="21:00" />
            <input type="time" id="horaCen3" value="22:00" />
          </div>
        </div>
        <div class="field">
          <label>&nbsp;</label>
          <div>
            <button id="btnRecalcular" type="button" class="btn-small secondary">鮫勇 Recalcular</button>
            <button id="btnGuardar" type="button" class="btn-small">游 Guardar</button>
          </div>
        </div>
      </div>
    </section>

    <!-- CONTENIDO PRINCIPAL: DOS COLUMNAS -->
    <section class="row">
      <!-- Panel izquierdo: grupos -->
      <div class="column long">
        <div class="panel-box">
          <div style="display:flex;justify-content:space-between;align-items:center;gap:.5rem;">
            <div>
              <h3>Grupos en Bariloche 췅 D칤a seleccionado</h3>
              <div class="panel-sub">
                Se muestran solo los grupos presentes en Bariloche en la fecha elegida (luego conectamos a Firestore).
              </div>
            </div>
            <div id="resumenGrupos" class="badge-chip">0 grupo(s) 췅 0 pax</div>
          </div>

          <div style="max-height:380px;overflow:auto;margin-top:.25rem;">
            <table id="tablaGrupos">
              <thead>
                <tr>
                  <th style="width:80px;">N춿 negocio</th>
                  <th>Grupo</th>
                  <th style="width:60px;">Pax</th>
                  <th>Coordinador</th>
                  <th style="width:90px;">Almuerzo</th>
                  <th style="width:90px;">Cena</th>
                </tr>
              </thead>
              <tbody id="tablaGruposBody">
                <!-- filas por JS -->
              </tbody>
            </table>
          </div>

          <p style="font-size:.75rem;color:#6b7280;margin-top:.45rem;">
            Puedes mover manualmente el turno de cada grupo. El bot칩n <strong>Recalcular</strong> reparte de forma autom치tica
            seg칰n la capacidad m치xima configurada.
          </p>
        </div>
      </div>

      <!-- Panel derecho: resumen turnos + texto -->
      <div class="column long">
        <div class="panel-box" style="margin-bottom:.75rem;">
          <div style="display:flex;justify-content:space-between;align-items:center;gap:.5rem;margin-bottom:.45rem;">
            <div>
              <h3>Turnos del d칤a</h3>
              <div class="panel-sub">
                Vista r치pida de almuerzos y cenas por horario, con total de pax por turno.
              </div>
            </div>
            <div id="resumenCapacidad" class="badge-chip">M치x 96 pax por turno</div>
          </div>

          <div class="turnos-grid" id="turnosGrid">
            <!-- tarjetas turno por JS -->
          </div>
        </div>

        <div class="panel-box whats-box">
          <div style="display:flex;justify-content:space-between;align-items:center;gap:.5rem;margin-bottom:.3rem;">
            <h3>Texto para WhatsApp / correo</h3>
            <button id="btnCopiarWhats" type="button" class="btn-small secondary">游늶 Copiar</button>
          </div>
          <textarea id="whatsText" readonly></textarea>
          <div class="help">
            Se genera en base a los turnos actuales (almuerzo y cena). Puedes pegarlo directo en WhatsApp del hotel/casino.
          </div>
        </div>
      </div>
    </section>
  </main>

  <!-- Recursos externos (mismos que en tus otras p치ginas) -->
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/choices.js/public/assets/scripts/choices.min.js"></script>

  <!-- Bootstrap del encabezado + m칩dulo -->
  <script type="module">
    (async () => {
      const html = await (await fetch('encabezado.html')).text();
      document.getElementById('encabezado').innerHTML = html;
  
      await import('./firebase-init.js');
      await import('./script.js');          // si quieres reutilizar header/usuario/reloj
      await import('./turnos-comida.js');   // 游녣 MISMO NOMBRE QUE EL ARCHIVO JS
    })();
  </script>
</body>
</html>
